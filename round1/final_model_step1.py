import math

def reward_function(params):
    # ─── 레이싱 라인 전체 좌표 (Spain CW) ───
    racing_track = [
        [8.54861, 3.17394, 3.5, 0.05761],
        [8.34696, 3.17288, 3.5, 0.05761],
        [8.14534, 3.16945, 2.2173, 0.09094],
        [7.9437,  3.17026, 2.2173, 0.09094],
        [7.74208, 3.17388, 2.2173, 0.09094],
        [7.54044, 3.17271, 2.10872,0.09562],
        [7.33883, 3.16878, 1.68122,0.11994],
        [7.13746, 3.17531, 1.5923, 0.12653],
        [6.93942, 3.2128,  1.5923, 0.12659],
        [6.74666, 3.27162, 1.5923, 0.12657],
        [6.5565,  3.33852, 1.5923, 0.1266 ],
        [6.35818, 3.37203, 1.5923, 0.12631],
        [6.15836, 3.3517,  1.5923, 0.12614],
        [5.97304, 3.27302, 1.78794,0.1126 ],
        [5.7831,  3.20663, 1.78794,0.11254],
        [5.58254, 3.18686, 3.16751,0.06362],
        [5.38186, 3.16761, 3.16751,0.06365],
        [5.18026, 3.16361, 3.5,     0.05761],
        [4.97861, 3.16373, 3.5,     0.05761],
        [4.777,   3.16781, 3.5,     0.05761],
        [4.57536, 3.16932, 3.5,     0.05761],
        [4.37371, 3.16804, 3.5,     0.05761],
        [4.17206, 3.16802, 3.5,     0.05761],
        [3.97041, 3.16883, 3.5,     0.05761],
        [3.76876, 3.16972, 3.5,     0.05761],
        [3.56711, 3.17069, 3.5,     0.05761],
        [3.36546, 3.17165, 3.5,     0.05761],
        [3.16381, 3.17214, 3.5,     0.05761],
        [2.96216, 3.1739,  3.5,     0.05761],
        [2.76053, 3.17645, 2.33917,0.08621],
        [2.55888, 3.17661, 2.18282,0.09238],
        [2.35727, 3.17291, 2.18282,0.09238],
        [2.15587, 3.16279, 2.07599,0.09713],
        [1.95429, 3.15845, 2.07599,0.09713],
        [1.75279, 3.16412, 1.48788,0.13548],
        [1.55414, 3.19761, 1.48374,0.13577],
        [1.36342, 3.2622,  1.48374,0.13572],
        [1.17883, 3.34299, 1.48374,0.1358 ],
        [0.98303, 3.39011, 1.48374,0.13573],
        [0.78205, 3.40232, 1.48374,0.13571],
        [0.58971, 3.34639, 1.48374,0.135  ],
        [0.42712, 3.2283,  1.51737,0.13243],
        [0.30783, 3.06674, 1.51737,0.13236],
        [0.24734, 2.87493, 2.66346,0.07551],
        [0.20758, 2.67724, 1.95971,0.1029 ],
        [0.16923, 2.47927, 1.64512,0.12258],
        [0.12879, 2.28172, 1.62044,0.12444],
        [0.08933, 2.08396, 1.58884,0.12692],
        [0.05045, 1.88609, 1.58884,0.12692],
        [0.01244, 1.68806, 1.58884,0.12692],
        [0.01407, 1.48727, 1.58884,0.12638],
        [0.07138, 1.29448, 1.58884,0.12659],
        [0.18121, 1.12628, 1.58884,0.12644],
        [0.33609, 0.99815, 1.69129,0.11885],
        [0.51934, 0.91513, 2.17231,0.09261],
        [0.71359, 0.86251, 2.64151,0.07619],
        [0.9113,  0.82284, 2.64151,0.07634],
        [1.11132, 0.79873, 2.64151,0.07627],
        [1.3122,  0.78331, 2.48667,0.08102],
        [1.51033, 0.74612, 2.48667,0.08107],
        [1.70378, 0.68944, 2.48667,0.08107],
        [1.89507, 0.62562, 2.48667,0.08109],
        [2.08593, 0.56055, 2.48667,0.08109],
        [2.27928, 0.50595, 2.22501,0.09029],
        [2.47854, 0.47534, 2.22501,0.09061],
        [2.679,   0.45341, 2.22501,0.09063],
        [2.87966, 0.43352, 2.01153,0.10025],
        [3.08048, 0.41525, 1.80145,0.11194],
        [3.28179, 0.41293, 1.80145,0.11175],
        [3.48132, 0.44145, 1.80145,0.11188],
        [3.67497, 0.49666, 1.80145,0.11178],
        [3.86265, 0.57016, 1.80145,0.11189],
        [4.06043, 0.60725, 1.80145,0.1117 ],
        [4.26142, 0.59741, 1.56655,0.12845],
        [4.45573, 0.54476, 1.56655,0.12851],
        [4.63522, 0.45377, 1.56655,0.12846],
        [4.8142,  0.36131, 1.56655,0.12859],
        [5.00562, 0.29867, 1.56655,0.12857],
        [5.20439, 0.26524, 1.56655,0.12867],
        [5.40246, 0.29377, 1.60486,0.1247 ],
        [5.58469, 0.37907, 1.76746,0.11384],
        [5.74973, 0.49457, 1.76746,0.11397],
        [5.89772, 0.63132, 1.76746,0.114  ],
        [6.02738, 0.78567, 1.76746,0.11405],
        [6.18866, 0.90566, 1.76746,0.11373],
        [6.37435, 0.98337, 2.0331, 0.09901],
        [6.57115, 1.02583, 1.79009,0.11247],
        [6.77196, 1.04399, 1.77219,0.11377],
        [6.97354, 1.04728, 1.51184,0.13335],
        [7.17288, 1.01777, 1.51184,0.13329],
        [7.37233, 0.9881,  1.48722,0.13559],
        [7.56838, 0.9427,  1.46155,0.13769],
        [7.74813, 0.85258, 1.46155,0.13758],
        [7.90125, 0.72181, 1.46155,0.13777],
        [8.00254, 0.54962, 1.46155,0.13669],
        [8.0774,  0.36339, 1.46155,0.13733],
        [8.21063, 0.21329, 1.46155,0.13732],
        [8.38762, 0.11911, 1.622,   0.12361],
        [8.58513, 0.07905, 3.5,     0.05758],
        [8.78439, 0.0481,  1.6431,  0.12273],
        [8.98469, 0.02489, 1.6431,  0.12272],
        [9.18583, 0.01077, 1.47457,0.13674],
        [9.38736, 0.00586, 1.4332, 0.14066],
        [9.38736, 0.00586, 1.4332, 0.0    ],
        [9.58741, 0.02668, 1.4332, 0.14033],
        [9.77374, 0.10227, 1.4332, 0.1403 ],
        [9.93298, 0.22484, 1.4332, 0.14022],
        [10.04023,0.39388, 1.4332, 0.13968],
        [10.07921,0.59097, 1.7908, 0.11219],
        [10.07081,0.7922,  3.09048,0.06517],
        [10.04642,0.99236, 3.5,     0.05761],
        [10.02742,1.19311, 3.5,     0.05761],
        [10.00581,1.3936,  3.5,     0.05761],
        [9.98378, 1.59404, 3.25622,0.06193],
        [9.96141, 1.79445, 1.54038,0.13091],
        [9.94145, 1.99511, 1.4,     0.14404],
        [9.91647, 2.1951,  1.4,     0.14396],
        [9.88355, 2.39404, 1.4,     0.14403],
        [9.85291, 2.59335, 1.4,     0.14404],
        [9.80824, 2.78935, 1.4,     0.14359],
        [9.70432, 2.96096, 1.4,     0.14331],
        [9.54351, 3.0803,  1.56491,0.12796],
        [9.35301, 3.14517, 2.00132,0.10056],
        [9.15341, 3.17298, 2.45628,0.08204],
        [8.9519,  3.17549, 3.5,     0.05758],
        [8.75026, 3.17344, 3.5,     0.05761]
    ]

    x, y    = params['x'], params['y']
    track_w = params['track_width']

    # 1) closest point
    dists = [math.hypot(x-p[0], y-p[1]) for p in racing_track]
    idx   = dists.index(min(dists))

    # 2) distance reward
    dist  = dists[idx]
    reward = max(1e-3, 1 - dist / (0.5 * track_w))

    return float(reward)
